<html>

<head>
    <script src="https://unpkg.com/streamr-client@5.4.4/streamr-client.web.js"></script>

</head>

<body>
    <button onclick='publish()'>Publish</button>
    <script>
        const log = (msg) => {
            var elem = document.createElement('p')
            elem.innerHTML = msg
            document.body.appendChild(elem)
        }

        let client;

        // REPLACE THIS WITH YOUR STREAM ID
        const STREAM_ID = 'YOUR-STREAM-ID'

        // REPLACE THIS WITH YOUR PRIVATE KEY
        const PRIVATE_KEY = 'YOUR-PRIVATE-KEY'

        if (STREAM_ID === 'YOUR-STREAM-ID') {
            log('You need to register a Streamr account and get a Stream ID before you can use this example. Register and get from https://streamr.network/signup')
        }

        if (PRIVATE_KEY === 'YOUR-PRIVATE-KEY') {
            log('You need to register a Streamr account and get a Private Key before you can use this example. Register and get from https://streamr.network/signup')
        } else {
            // Create the client and give the private key to use by default
            client = new StreamrClient({
                auth: {
                    privateKey: PRIVATE_KEY,
                }
            })
        }

        function publish() {
            // Here is the event we'll be sending
            const msg = {
                hello: 'world',
                random: Math.random()
            }

            if (!client) {
                log('Client hasn\'t been initialized. This is likely because you still need to replace the Stream ID and private key.');
                return;
            }

            // Publish the event to the Stream
            client.publish(STREAM_ID, msg)
                .then(() => log(`Sent successfully: ${JSON.stringify(msg)}`))
                .catch((err) => log(err))
        }
    </script>
</body>

</html>